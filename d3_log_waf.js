awsData=[{"timestamp":1686121868681,"formatVersion":1,"webaclId":"arn:aws:wafv2:us-east-1:944697335072:regional/webacl/cloudmonitoring-waf/c8d5f50c-9912-41c9-827b-f7562087c5a5","terminatingRuleId":"AWS-AWSManagedRulesAnonymousIpList","terminatingRuleType":"MANAGED_RULE_GROUP","action":"BLOCK","terminatingRuleMatchDetails":[],"httpSourceName":"ALB","httpSourceId":"944697335072-app/alb/1e3b6eac51c9c245","ruleGroupList":[{"ruleGroupId":"AWS#AWSManagedRulesAnonymousIpList","terminatingRule":{"ruleId":"HostingProviderIPList","action":"BLOCK","ruleMatchDetails":null},"nonTerminatingMatchingRules":[],"excludedRules":null,"customerConfig":null}],"rateBasedRuleList":[],"nonTerminatingMatchingRules":[],"requestHeadersInserted":null,"responseCodeSent":null,"httpRequest":{"clientIp":"185.254.196.173","country":"US","headers":[{"name":"Host","value":"34.193.165.126"},{"name":"User-agent","value":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.129 Safari/537.36"},{"name":"Accept-Encoding","value":"gzip, deflate"},{"name":"Accept","value":"*/*"},{"name":"Connection","value":"keep-alive"}],"uri":"/.env","args":"REDACTED","httpVersion":"HTTP/1.1","httpMethod":"GET","requestId":"1-64802d8c-1e04583618dc9c934d15ae20"},"labels":[{"name":"awswaf:managed:aws:anonymous-ip-list:HostingProviderIPList"}]},
{"timestamp":1686121869945,"formatVersion":1,"webaclId":"arn:aws:wafv2:us-east-1:944697335072:regional/webacl/cloudmonitoring-waf/c8d5f50c-9912-41c9-827b-f7562087c5a5","terminatingRuleId":"AWS-AWSManagedRulesAnonymousIpList","terminatingRuleType":"MANAGED_RULE_GROUP","action":"BLOCK","terminatingRuleMatchDetails":[],"httpSourceName":"ALB","httpSourceId":"944697335072-app/alb/1e3b6eac51c9c245","ruleGroupList":[{"ruleGroupId":"AWS#AWSManagedRulesAnonymousIpList","terminatingRule":{"ruleId":"HostingProviderIPList","action":"BLOCK","ruleMatchDetails":null},"nonTerminatingMatchingRules":[],"excludedRules":null,"customerConfig":null}],"rateBasedRuleList":[],"nonTerminatingMatchingRules":[],"requestHeadersInserted":null,"responseCodeSent":null,"httpRequest":{"clientIp":"185.254.196.173","country":"US","headers":[{"name":"Host","value":"34.193.165.126"},{"name":"User-agent","value":"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/81.0.4044.129 Safari/537.36"},{"name":"Accept-Encoding","value":"gzip, deflate"},{"name":"Accept","value":"*/*"},{"name":"Connection","value":"keep-alive"},{"name":"Content-Length","value":"15"},{"name":"Content-Type","value":"application/x-www-form-urlencoded"}],"uri":"/","args":"REDACTED","httpVersion":"HTTP/1.1","httpMethod":"POST","requestId":"1-64802d8d-58f05d3c4076346521f4a0a1"},"labels":[{"name":"awswaf:managed:aws:anonymous-ip-list:HostingProviderIPList"}],"requestBodySize":15,"requestBodySizeInspectedByWAF":15},
{"timestamp":1686122069451,"formatVersion":1,"webaclId":"arn:aws:wafv2:us-east-1:944697335072:regional/webacl/cloudmonitoring-waf/c8d5f50c-9912-41c9-827b-f7562087c5a5","terminatingRuleId":"AWS-AWSManagedRulesAnonymousIpList","terminatingRuleType":"MANAGED_RULE_GROUP","action":"BLOCK","terminatingRuleMatchDetails":[],"httpSourceName":"ALB","httpSourceId":"944697335072-app/alb/1e3b6eac51c9c245","ruleGroupList":[{"ruleGroupId":"AWS#AWSManagedRulesAnonymousIpList","terminatingRule":{"ruleId":"HostingProviderIPList","action":"BLOCK","ruleMatchDetails":null},"nonTerminatingMatchingRules":[],"excludedRules":null,"customerConfig":null}],"rateBasedRuleList":[],"nonTerminatingMatchingRules":[],"requestHeadersInserted":null,"responseCodeSent":null,"httpRequest":{"clientIp":"159.65.219.198","country":"US","headers":[{"name":"Host","value":"52.45.198.201"},{"name":"User-Agent","value":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.61 Safari/537.36"},{"name":"Accept-Encoding","value":"gzip, deflate"},{"name":"Accept","value":"*/*"},{"name":"Connection","value":"keep-alive"},{"name":"Cookie","value":"oInnSJKRfeFi=mEKiQrsvlaKxYknBCZ/m2QEp7Co="}],"uri":"/favicon.ico","args":"REDACTED","httpVersion":"HTTP/1.1","httpMethod":"GET","requestId":"1-64802e55-5931214f4a5c345f5720604b"},"labels":[{"name":"awswaf:managed:aws:anonymous-ip-list:HostingProviderIPList"}]},
{"timestamp":1686122069405,"formatVersion":1,"webaclId":"arn:aws:wafv2:us-east-1:944697335072:regional/webacl/cloudmonitoring-waf/c8d5f50c-9912-41c9-827b-f7562087c5a5","terminatingRuleId":"AWS-AWSManagedRulesAnonymousIpList","terminatingRuleType":"MANAGED_RULE_GROUP","action":"BLOCK","terminatingRuleMatchDetails":[],"httpSourceName":"ALB","httpSourceId":"944697335072-app/alb/1e3b6eac51c9c245","ruleGroupList":[{"ruleGroupId":"AWS#AWSManagedRulesAnonymousIpList","terminatingRule":{"ruleId":"HostingProviderIPList","action":"BLOCK","ruleMatchDetails":null},"nonTerminatingMatchingRules":[],"excludedRules":null,"customerConfig":null}],"rateBasedRuleList":[],"nonTerminatingMatchingRules":[],"requestHeadersInserted":null,"responseCodeSent":null,"httpRequest":{"clientIp":"159.65.219.198","country":"US","headers":[{"name":"Host","value":"52.45.198.201"},{"name":"User-Agent","value":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.61 Safari/537.36"},{"name":"Accept-Encoding","value":"gzip, deflate"},{"name":"Accept","value":"*/*"},{"name":"Connection","value":"keep-alive"},{"name":"Cookie","value":"oInnSJKRfeFi=mEKiQrsvlaKxYknBCZ/m2QEp7Co="}],"uri":"/download/po","args":"REDACTED","httpVersion":"HTTP/1.1","httpMethod":"GET","requestId":"1-64802e55-3a45347943b80c2f652dde4e"},"labels":[{"name":"awswaf:managed:aws:anonymous-ip-list:HostingProviderIPList"}]},
];
  /*
function dataList(){
    timeData = data.timestamp;
    ruleSet = data.labels.name;
    act = data.action;
    sourceID = data.httpSourceId;
    ipData = data.httpRequest.clientIp;
    ipCountry = data.httpRequest.country;
}*/
/*
function dataEdit(){
    let lastName = "";
    dataName = data.labels.name;
    for(let i = 0; i<dataName.length; i++){
        if(dataName=='-'){
            console.log(i);
            console.log(lastName);
        }
        else{
            lastName = lastName+data.lables.name[i];
            console.log(lastName);
        }
    }
    document.write(lastName) ;

    return 0;
}
*/
const options = {
  timeZone: 'Asia/Seoul',
  year: 'numeric',
  month: 'long',
  day: 'numeric',
  hour: 'numeric',
  minute: 'numeric',
  second: 'numeric',
};

function parsingData(i){
  const dataTime = new Date(awsData[i].timestamp)
  const utcDate = dataTime.toUTCString();
  const koreaTime = dataTime.toLocaleString('en-US',options);

  var dataList = {
    timeData: koreaTime,
    ruleSet: awsData[i].labels[0].name,
    act : awsData[i].action,
    sourceID : awsData[i].httpSourceId,
    ipData : awsData[i].httpRequest.clientIp,
    ipCountry : awsData[i].httpRequest.country};
  
    return dataList;
}


function toDOM(row) {
    var tr = "";
    tr += "<tr>";
    tr += "  <td>" + row.timeData + "</td>";
    tr += "  <td>" + row.ruleSet + "</td>";
    tr += "  <td>" + row.act + "</td>";
    tr += "  <td>" + row.sourceID + "</td>";
    tr += "  <td>" + row.ipData + "</td>";
    tr += "  <td>" + row.ipCountry + "</td>";
    tr += "</tr>";
    return tr;
}
function renderTable(id, dataList) {
    var size = dataList.length;
    var trList = "";
    for (var i = 0; i < size; i++) {
    trList += toDOM(parsingData(i));
    }
    document.querySelector("#" + id + " tbody").innerHTML = trList;
    }

window.onload = function getTable() {
    renderTable("table", awsData);
};